<div class="min-h-screen bg-slate-950 text-slate-100">
  <div class="max-w-7xl mx-auto px-6 py-8">
    <h1 class="text-3xl font-bold mb-2">Users</h1>
    <p class="text-slate-400">User CRUD</p>
  </div>

  <div class="max-w-7xl mx-auto px-6 mb-4 flex items-end">
    <div class="">
      <form (ngSubmit)="onSubmit()" class="flex gap-2 items-end">
        <input
          [(ngModel)]="newUser._id"
          name="_id"
          placeholder="ID"
          class="rounded bg-slate-800 text-slate-100 px-4 py-2 transition text-sm font-medium"
          [disabled]="isEditMode"
          required
        />
        <input
          [(ngModel)]="newUser.name"
          name="name"
          placeholder="Name"
          class="rounded bg-slate-800 text-slate-100 px-4 py-2 transition text-sm font-medium"
          required
        />
        <input
          [(ngModel)]="newUser.email"
          name="email"
          placeholder="Email"
          class="rounded bg-slate-800 text-slate-100 px-4 py-2 transition text-sm font-medium"
          required
        />
        <input
          [(ngModel)]="newUser.location"
          name="location"
          placeholder="Location"
          class="rounded bg-slate-800 text-slate-100 px-4 py-2 transition text-sm font-medium"
          required
        />
        <button
          type="submit"
          class="px-4 py-2 rounded-md bg-emerald-600 hover:bg-emerald-500 transition text-sm font-medium"
        >
          {{ isEditMode ? 'Edit user' : 'Add User' }}
        </button>
        @if (isEditMode) {
          <button
            type="button"
            (click)="cancelEdit()"
            class="px-4 py-2 rounded-md bg-slate-700 hover:bg-slate-600 transition text-sm font-medium"
          >
            Cancel
          </button>
        }
      </form>
    </div>
    <div class="flex ml-auto gap-2">
      <a
        routerLink="/home"
        class="px-4 py-2 rounded-md bg-orange-500 hover:bg-orange-400 transition text-sm font-medium"
      >
        Home
      </a>

      <button
        class="px-4 py-2 rounded-md bg-slate-800 hover:bg-slate-700 transition text-sm text-slate-300"
      >
        Download CSV
      </button>
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-6 pb-12">
    @if (userService.loadingSignal()) {
      <div class="text-center py-12 text-slate-400">
        <div class="animate-pulse">Loading users...</div>
      </div>
    }

    @if (!userService.loadingSignal() && userService.usersSignal().length === 0) {
      <div class="text-center py-12 text-slate-400">
        <p class="text-lg mb-2">No users found</p>
      </div>
    }

    @if (!userService.loadingSignal() && userService.usersSignal().length > 0) {
      <div class="overflow-x-auto rounded-lg border border-slate-800">
        <table class="w-full text-sm">
          <thead class="bg-slate-900 text-slate-400">
            <tr>
              <th class="px-4 py-3 text-left">ID</th>
              <th class="px-4 py-3 text-left">First</th>
              <th class="px-4 py-3 text-left">Last</th>
              <th class="px-4 py-3 text-left">Email</th>
              <th class="px-4 py-3 text-left">Location</th>
              <th class="px-4 py-3 text-left">Actions</th>
            </tr>
          </thead>

          <tbody class="divide-y divide-slate-800">
            @for (user of userService.usersSignal(); track user._id) {
              <tr class="hover:bg-slate-900/50 transition">
                <td class="px-4 py-3 text-slate-400 font-mono text-xs" [title]="user._id">
                  {{ user._id }}
                </td>
                <td class="px-4 py-3">{{ user.name.split(' ')[0] }}</td>
                <td class="px-4 py-3">{{ user.name.split(' ').slice(-1)[0] }}</td>
                <td class="px-4 py-3 text-slate-400">{{ user.email }}</td>
                <td class="px-4 py-3 text-slate-400">{{ user.location }}</td>
                <td class="px-4 py-3 flex gap-2">
                  <button
                    class="px-3 py-1 rounded bg-amber-500/90 hover:bg-amber-500 text-xs font-medium text-black"
                    (click)="loadUserForEdit(user)"
                  >
                    Edit
                  </button>
                  <button
                    class="px-3 py-1 rounded bg-red-600/90 hover:bg-red-600 text-xs font-medium"
                    (click)="onDelete(user._id)"
                  >
                    Delete
                  </button>
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    }
  </div>
</div>
